function makeRequest(e,t,n="POST",o="core/rcon.php"){let a=new XMLHttpRequest;a.open(n,o),a.onload=function(){4==this.readyState&&200==this.status&&t(JSON.parse(this.responseText))};let r=new FormData;for(let t in e)r.append(t,e[t]);a.send(r)}function get_players(sv){makeRequest({get_players:sv},(function(resp){document.getElementById("edamodal").innerHTML="<table class='table table table-bordered table-striped table-custom'><thead><tr><th scope='col'>#</th><th scope='col'>Имя</th><th scope='col'>Время на сервере</th><th scope='col'>Счёт</th></tr></thead><tbody id='sudalol'></tbody></table>",document.getElementById("staticBackdropLabel").innerHTML="Список игроков "+sv;var myModal=new bootstrap.Modal(document.getElementById("atakda"));myModal.toggle();for(var i=0,row;row=resp[i];i++)row.Name=""!=row.Name?row.Name:"Подключается...",document.getElementById("sudalol").innerHTML+="<th scope='row'>"+eval(i+1)+"</th><td>"+row.Name+"</td><td>"+row.TimeF+"</td><td>"+row.Frags+"</td></tr>"}))}function get_servers(){let e=document.getElementById("serverList");e&&makeRequest({get_servers:!0},(function(t){for(let n,o=0;n=t[o];o++){let t=`server-${o}`;e.innerHTML+=`\n <div class='card mb-3 hoverscale border-0 bggrad text-white' id='${t}' style='border-radius:20px; overflow: hidden;'>\n <h3 class='fw-bold mt-1'>${n.sv_name}</h3>\n <h5 id='${t}-map' style='margin-top: auto;'>карта: Загрузка...</h5>\n <div class='btn-group btn-sm mt-1 input-block-level' role='group'>\n <button type='button' class='btn btn-light border-dark fw-bold bg-white btn-sm' id='${t}-btn'>\n Игроки: ...\n </button>\n <a type='button' href='steam://connect/${n.sv_ip}:${n.sv_port}' class='btn btn btn-light border-dark fw-bold bg-white btn-sm'>\n <i class='bi bi-plugin'></i> Подключиться\n </a>\n <a type='button' class='btn btn btn-light border-dark fw-bold bg-white btn-sm' href='components/donate.php?sv=${n.sv_name}'>\n <i class='bi bi-bag-heart'></i> Пожертвование\n </a>\n </div>\n </div>\n `,load_rcon_data(n.sv_name,t)}}),"POST","core/api.php")}function load_rcon_data(e,t){makeRequest({get_single_server:e},(function(n){if(!n||!n.query)return;document.getElementById(`${t}-map`).textContent="карта: "+n.query.map;let o=document.getElementById(`${t}-btn`);o.textContent=`Игроки: ${n.query.players}/${n.query.playersmax}`,o.setAttribute("onclick",`get_players('${e}')`)}))}document.addEventListener("DOMContentLoaded",get_servers());